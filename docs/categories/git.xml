<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>凡云的博客 (关于文章 git)</title><link>http://blog.cloudnie.ort/</link><description></description><atom:link href="http://blog.cloudnie.ort/categories/git.xml" rel="self" type="application/rss+xml"></atom:link><language>zh_cn</language><lastBuildDate>Sun, 23 Apr 2023 13:40:34 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>repo sync 加速</title><link>http://blog.cloudnie.ort/posts/speed-up-the-downloading-of-sdk/</link><dc:creator>CloudNie</dc:creator><description>&lt;p&gt;项目是用 repo 来管理 SDK，随着 SDK 中包含的仓库越来越多，以及单个仓库的体积越来越大，下载 SDK 的时间越来越长，目前已经超过了 15 分钟。
有没有办法加速 SDK 的下载？ 答案是有的，就是利用  repo 命令的 --reference 参数，可以将下载时间优化到 1 分钟左右。&lt;/p&gt;
&lt;p&gt;该方法需要先创建本地 SDK mirror，然后在执行 repo init 命令的时候设定 --reference 参数。
SDK mirror 只需要创建一次，未来 sync 代码时可以重复使用。&lt;/p&gt;
&lt;p&gt;创建 SDK mirror:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_889b2214ea394a119eb969156ae294f6-1" name="rest_code_889b2214ea394a119eb969156ae294f6-1" href="http://blog.cloudnie.ort/posts/speed-up-the-downloading-of-sdk/#rest_code_889b2214ea394a119eb969156ae294f6-1"&gt;&lt;/a&gt;mkdir sdk_repo_mirror
&lt;a id="rest_code_889b2214ea394a119eb969156ae294f6-2" name="rest_code_889b2214ea394a119eb969156ae294f6-2" href="http://blog.cloudnie.ort/posts/speed-up-the-downloading-of-sdk/#rest_code_889b2214ea394a119eb969156ae294f6-2"&gt;&lt;/a&gt;cd sdk_repo_mirror
&lt;a id="rest_code_889b2214ea394a119eb969156ae294f6-3" name="rest_code_889b2214ea394a119eb969156ae294f6-3" href="http://blog.cloudnie.ort/posts/speed-up-the-downloading-of-sdk/#rest_code_889b2214ea394a119eb969156ae294f6-3"&gt;&lt;/a&gt;repo init -u ssh://YOUR_ACOUNT@GERRIT_HOST/manifest --mirror
&lt;a id="rest_code_889b2214ea394a119eb969156ae294f6-4" name="rest_code_889b2214ea394a119eb969156ae294f6-4" href="http://blog.cloudnie.ort/posts/speed-up-the-downloading-of-sdk/#rest_code_889b2214ea394a119eb969156ae294f6-4"&gt;&lt;/a&gt;repo sync --no-tags;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Download SDK Source:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_6b670f79662b4107ac220bdfe07e3934-1" name="rest_code_6b670f79662b4107ac220bdfe07e3934-1" href="http://blog.cloudnie.ort/posts/speed-up-the-downloading-of-sdk/#rest_code_6b670f79662b4107ac220bdfe07e3934-1"&gt;&lt;/a&gt;mkdir sdk_work
&lt;a id="rest_code_6b670f79662b4107ac220bdfe07e3934-2" name="rest_code_6b670f79662b4107ac220bdfe07e3934-2" href="http://blog.cloudnie.ort/posts/speed-up-the-downloading-of-sdk/#rest_code_6b670f79662b4107ac220bdfe07e3934-2"&gt;&lt;/a&gt;cd sdk_work
&lt;a id="rest_code_6b670f79662b4107ac220bdfe07e3934-3" name="rest_code_6b670f79662b4107ac220bdfe07e3934-3" href="http://blog.cloudnie.ort/posts/speed-up-the-downloading-of-sdk/#rest_code_6b670f79662b4107ac220bdfe07e3934-3"&gt;&lt;/a&gt;repo init -u ssh://YOUR_ACOUNT@GERRIT_HOST/manifest --reference=YOUR_SDK_MIRROR_PATH
&lt;a id="rest_code_6b670f79662b4107ac220bdfe07e3934-4" name="rest_code_6b670f79662b4107ac220bdfe07e3934-4" href="http://blog.cloudnie.ort/posts/speed-up-the-downloading-of-sdk/#rest_code_6b670f79662b4107ac220bdfe07e3934-4"&gt;&lt;/a&gt;repo sync
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;repo 仓库中的注释:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_3498eb2e3da94222bc7c89dd4d1ea1e9-1" name="rest_code_3498eb2e3da94222bc7c89dd4d1ea1e9-1" href="http://blog.cloudnie.ort/posts/speed-up-the-downloading-of-sdk/#rest_code_3498eb2e3da94222bc7c89dd4d1ea1e9-1"&gt;&lt;/a&gt;The --reference option can be used to point to a directory that has the content of a --mirror sync. This will make the working
&lt;a id="rest_code_3498eb2e3da94222bc7c89dd4d1ea1e9-2" name="rest_code_3498eb2e3da94222bc7c89dd4d1ea1e9-2" href="http://blog.cloudnie.ort/posts/speed-up-the-downloading-of-sdk/#rest_code_3498eb2e3da94222bc7c89dd4d1ea1e9-2"&gt;&lt;/a&gt;directory use as much data as possible from the local reference directory when fetching from the server. This will make the sync
&lt;a id="rest_code_3498eb2e3da94222bc7c89dd4d1ea1e9-3" name="rest_code_3498eb2e3da94222bc7c89dd4d1ea1e9-3" href="http://blog.cloudnie.ort/posts/speed-up-the-downloading-of-sdk/#rest_code_3498eb2e3da94222bc7c89dd4d1ea1e9-3"&gt;&lt;/a&gt;go a lot faster by reducing data traffic on the network.
&lt;/pre&gt;&lt;/div&gt;</description><category>git</category><category>repo</category><guid>http://blog.cloudnie.ort/posts/speed-up-the-downloading-of-sdk/</guid><pubDate>Tue, 05 Sep 2017 07:32:28 GMT</pubDate></item></channel></rss>